%define  RELEASE 1
%define  rel     %{?CUSTOM_RELEASE} %{!?CUSTOM_RELEASE:%RELEASE}

%define lib_name ulxmlrpcpp

Name: @PACKAGE@
Version: @VERSION@
Release: %rel

Summary: Ultra Leightweight XML-RPC Library for C++
Copyright: LGPL
Group: Development/Libraries
Vendor: The ulxmlrpcpp Project
Packager: ulxmlrpcpp@ewald-arnold.de
Url: http://ulxmlrpcpp.sourceforge.net/
Requires: expat >= 1.95.0

Source: ftp://download.sourceforge.net/pub/sourceforge/ulxmlrpcpp/%name-%version.tar.gz

Prefix: %_prefix
BuildRoot: %_tmppath/%name-%version-root

%description
Ultra Leightweight XML-RPC Library for C++

%package doc
Summary: HTML formatted API documention and handbook for ULXMLRPCPP
Group: Development/Libraries
Requires: %name = %version

%description doc
The %name-doc package contains HTML formatted API documention generated by
the popular doxygen documentation generation tool.

%prep
%__rm -rf $RPM_BUILD_ROOT

%setup
CFLAGS="$RPM_OPT_FLAGS" ./configure --prefix=%{prefix} --enable-doxygen

%build
%__make all doc

%install
%__rm -rf $RPM_BUILD_ROOT
%__make prefix=$RPM_BUILD_ROOT%{prefix} install
%__mkdir -p $RPM_BUILD_ROOT%{prefix}/share/doc/packages
%__mv $RPM_BUILD_ROOT%{prefix}/share/%lib_name/html $RPM_BUILD_ROOT%{prefix}/share/doc/packages/%lib_name
%__cp AUTHORS $RPM_BUILD_ROOT%{prefix}/share/doc/packages/%lib_name
%__cp COPYING $RPM_BUILD_ROOT%{prefix}/share/doc/packages/%lib_name
%__cp README $RPM_BUILD_ROOT%{prefix}/share/doc/packages/%lib_name
%__cp ChangeLog $RPM_BUILD_ROOT%{prefix}/share/doc/packages/%lib_name

%clean
%__rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root,755)
%attr(755,root,root) %prefix/lib/lib*.so.*
%prefix/share/doc/packages/%lib_name/AUTHORS
%prefix/share/doc/packages/%lib_name/COPYING
%prefix/share/doc/packages/%lib_name/README
%prefix/share/doc/packages/%lib_name/ChangeLog
%prefix/include/*
%prefix/share/%lib_name/httpd/*
%prefix/bin/*
%attr(755,root,root) %prefix/lib/lib*.so
%attr(644,root,root) %prefix/lib/*.*a

%files doc
%prefix/share/doc/packages/%lib_name/*
